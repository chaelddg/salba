<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title><%= title %></title>
    <link rel="stylesheet" type="text/css" href="/lib/foundation/css/foundation.css">
    <link rel="stylesheet" type="text/css" href="/lib/foundation-icon-fonts/foundation-icons.css">
    <link rel="stylesheet" type="text/css" href="/lib/datatable/media/css/jquery.dataTables.css">
</head>
<body>

  <div class="off-canvas-wrap" data-offcanvas>
    <div class="inner-wrap">
      <nav class="tab-bar">
        <section class="left-small">
          <a class="left-off-canvas-toggle menu-icon"><span></span></a>
        </section>

        <section class="middle tab-bar-section">
          <h1 class="title">Admin</h1>
        </section>

        <section class="right">
          <a href="/signout">Sign Out</a>
        </section>

      </nav>

      <aside class="left-off-canvas-menu">
        <ul class="off-canvas-list">
          <li><label>Menu</label></li>
          <li><a href="/admin/dashboard">Book Categories</a></li>
          <li><a href="/admin/dashboard/logs">Logs</a></li>
          <li><a href="/admin/dashboard/borrowers">Borrowers</a></li>
          <li><a href="/admin/dashboard/borrowerreservelist">Borrowers Reserved List</a></li>
          <li><a href="/admin/dashboard/borrowerrequest">Borrower Requests</a></li>
        </ul>
      </aside>

      <section class="row" id="content-section">

        <!-- ************* MODAL ******************* -->
            <div id="accept-modal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
              <p id="accept-test"></p>
              <form method="POST" action="/admin/dashboard/borrowers">
                  <div class="row">
                      <div class="large-12 columns">
                          <label>
                              <input type="hidden" value="" id="accept_reqid" name="accept_reqid" />
                              <input type="submit" class="button small info" value="Save Borrower" />
                          </label>
                      </div>
                  </div>
              </form>
              <a class="close-reveal-modal" aria-label="Close">&#215;</a>
          </div>

          <div id="decline-modal" class="reveal-modal" data-reveal aria-labelledby="modalTitle" aria-hidden="true" role="dialog">
              <p id="decline-test"></p>
              <form method="POST" action="/admin/dashboard/borrwerdecline">
                  <div class="row">
                      <div class="large-12 columns">
                          <label>
                              <input type="hidden" value="" id="decline_reqid" name="decline_reqid" />
                              <input type="submit" class="button small alert" value="Delete Reservation" />
                          </label>
                      </div>
                  </div>
              </form>
              <a class="close-reveal-modal" aria-label="Close">&#215;</a>
          </div>
        <!-- END MODAL -->

        <br />

        <table id="inventory_table" style="margin-top: 10px; width: 100%">
          <thead>
            <tr>
              <th style="text-align: center">Request ID</th>
              <th style="text-align: center">Title</th>
              <th style="text-align: center">Author</th>
              <th style="text-align: center">Dute Date</th>
              <th style="text-align: center">Status</th>
              <th style="text-align: center">Action</th>
            </tr>
          </thead>
          <tbody>
             <% bookData.forEach(function(data, i) {%>

              <tr>
                <td style="text-align: center"><%= data._id %></td>
                <td style="text-align: center"><%= data.title %></td>
                <td style="text-align: center"><%= data.author %></td>
                <td style="text-align: center"><%= data.due_date ? moment(data.due_date).format('llll') : " --- " %></td>
                <td style="text-align: center">
                  <p style="padding-top: 28px">
                      <i style="color: orange; font-size: 16px"> <%= data.status %></i>
                  </p>
                </td>
                <td style="text-align: center">
                      <p style="padding-top: 28px">
                         <i class="fi-save button tiny request-btn" data-reveal-id="accept-modal" id="<%= data._id %>" style="background-color: transparent; color: cornflowerblue; font-size: 24px"></i>
                         <i class="fi-trash button tiny decline-btn" data-reveal-id="decline-modal" data-decline="<%= data._id %>" style="background-color: transparent; color: red; font-size: 24px"></i>
                      </p>
                    </td>
                </tr>
            <% }); %>
          </tbody>
        </table>

      </section>

      <a class="exit-off-canvas"></a>

    </div>
  </div>

    <script type="text/javascript" src="/lib/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="/lib/foundation/js/foundation.js"></script>
    <script type="text/javascript" src="/lib/datatable/media/js/jquery.dataTables.js"></script>
    <script type="text/javascript" src="/assets/js/datatable.js"></script>
    <script type="text/javascript" src="/assets/js/foundation.js"></script>

    <script>
        $(document).ready(function() {

          var getId = window.location.href.split("/");
          var userID = getId[getId.length-1];

          $(".request-btn").click(function(e) {
            var requestID = $(this).attr("id");
            console.log(requestID);
            $("#accept_reqid").val(requestID);
            $("#accept-test").html("Add Request <i style=\"color: green\">" + requestID + "</i> to Borrower");
          });

          $(".decline-btn").click(function(e) {
            var requestID = $(this).attr("data-decline");
            console.log(requestID);
            $("#decline_reqid").val(requestID);
            $("#decline-test").html("Delete Request <i style=\"color: red\">" + requestID + "</i>");
          });

        });
    </script>

</body>
</html>
